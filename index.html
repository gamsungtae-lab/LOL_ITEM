<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoL ìŠ¤ë§ˆíŠ¸ ì•„ì´í…œ ì—°êµ¬ì†Œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* [í…Œë§ˆ: í—¥ìŠ¤í…Œí¬ í“¨ì²˜] */
        body { 
            background-color: #050a10; color: #c8aa6e; 
            font-family: 'Pretendard', sans-serif; text-align: center; 
            padding: 20px; margin: 0;
        }

        /* --- 1. ìŠ¤ë§ˆíŠ¸ ë¹Œë” (ìŠ¬ë¼ì´ë” ì˜ì—­) --- */
        .smart-builder {
            background: linear-gradient(145deg, #16213e, #0f1525);
            border: 2px solid #c8aa6e; border-radius: 15px;
            padding: 20px; max-width: 800px; margin: 0 auto 30px auto;
            box-shadow: 0 0 20px rgba(200, 170, 110, 0.2);
        }
        .builder-title { font-size: 1.5em; font-weight: bold; margin-bottom: 15px; display: block; color: #fff; }
        .slider-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: left; }
        .slider-group { margin-bottom: 5px; }
        .slider-label { display: flex; justify-content: space-between; color: #aaa; font-size: 14px; margin-bottom: 5px; }
        input[type=range] { width: 100%; accent-color: #c8aa6e; cursor: pointer; }
        
        .generate-btn {
            background: #c8aa6e; color: #000; font-weight: bold; font-size: 16px;
            border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer;
            margin-top: 20px; transition: 0.3s; width: 100%;
        }
        .generate-btn:hover { background: #fff; box-shadow: 0 0 15px #c8aa6e; transform: scale(1.02); }

        /* --- 2. í´ë˜ìŠ¤ë³„ í”„ë¦¬ì…‹ ë²„íŠ¼ --- */
        .preset-bar { margin-bottom: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; max-width: 900px; margin: 0 auto 30px auto; }
        .preset-btn {
            background: #1e2328; color: #aaa; border: 1px solid #444;
            padding: 8px 15px; cursor: pointer; border-radius: 4px; font-size: 13px; transition: 0.2s;
        }
        .preset-btn:hover { background: #005a82; color: #fff; border-color: #00d2d3; }
        
        .category-header { 
            width: 100%; color: #c8aa6e; font-weight:bold; font-size: 14px; 
            margin: 15px 0 5px 0; border-bottom: 1px solid #333; padding-bottom: 5px;
        }

        /* ê°•ì¡° ìŠ¤íƒ€ì¼ */
        .adc-btn { border-color: #c8aa6e; color: #c8aa6e; background: rgba(200, 170, 110, 0.1); }
        .adc-btn:hover { background: #c8aa6e; color: #000; }
        
        .jg-btn { border-color: #00d2d3; color: #00d2d3; background: rgba(0, 210, 211, 0.1); }
        .jg-btn:hover { background: #00d2d3; color: #000; }

        /* --- 3. ì¸ë²¤í† ë¦¬ --- */
        .inventory-box { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; }
        .slot { 
            width: 60px; height: 60px; background: #010a13; border: 2px solid #333; 
            border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; position: relative;
        }
        .slot img { width: 100%; height: 100%; border-radius: 6px; }
        .slot:hover { border-color: #f0e6d2; }
        .slot-hint { position: absolute; font-size: 10px; color: #555; bottom: 2px; }

        /* --- 4. ë¶„ì„ ê²°ê³¼ (í‘œ) --- */
        .analysis-box { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; max-width: 900px; margin: 0 auto; }
        .table-container { flex: 1; min-width: 300px; background: #111; border-radius: 10px; padding: 15px; border: 1px solid #333; }
        .stat-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .stat-table td { padding: 6px; border-bottom: 1px solid #222; text-align: right; color: #c8aa6e; }
        .stat-table .label { text-align: left; color: #aaa; }
        .total-gold { color: gold; font-size: 18px; font-weight: bold; text-align: right; display: block; margin-bottom: 10px; }

        /* ì•„ì´í…œ ë¦¬ìŠ¤íŠ¸ */
        .search-box { margin: 30px 0 10px 0; }
        .search-box input { padding: 10px; width: 300px; background: #222; border: 1px solid #444; color: white; text-align: center; }
        .item-list { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; max-width: 1000px; margin: 0 auto 50px auto; }
        .item-card { width: 45px; height: 45px; cursor: pointer; border: 1px solid #333; }
        .item-card:hover { transform: scale(1.2); border-color: gold; z-index: 10; }
        .item-card img { width: 100%; height: 100%; }

    </style>
</head>
<body>

    <h1>ğŸ§  LoL ì•„ì´í…œ ì—°êµ¬ì†Œ <span style="font-size:0.5em; color:#555;">Ver 3.2</span></h1>

    <div class="smart-builder">
        <span class="builder-title">ğŸ¤– AI ìë™ ì¶”ì²œ (ìŠ¤íƒ¯ ì„¤ì •)</span>
        <div class="slider-grid">
            <div class="slider-group">
                <div class="slider-label"><span>âš”ï¸ ê³µê²©ë ¥</span> <span id="val_ad">0</span></div>
                <input type="range" id="range_ad" min="0" max="10" value="0" oninput="updateRangeVal('val_ad', this.value)">
            </div>
            <div class="slider-group">
                <div class="slider-label"><span>ğŸ”® ì£¼ë¬¸ë ¥</span> <span id="val_ap">0</span></div>
                <input type="range" id="range_ap" min="0" max="10" value="0" oninput="updateRangeVal('val_ap', this.value)">
            </div>
            <div class="slider-group">
                <div class="slider-label"><span>ğŸ›¡ï¸ íƒ±í‚¹(ì²´ë ¥/ë°©ì–´)</span> <span id="val_tank">0</span></div>
                <input type="range" id="range_tank" min="0" max="10" value="0" oninput="updateRangeVal('val_tank', this.value)">
            </div>
            <div class="slider-group">
                <div class="slider-label"><span>âš¡ ê³µê²© ì†ë„</span> <span id="val_as">0</span></div>
                <input type="range" id="range_as" min="0" max="10" value="0" oninput="updateRangeVal('val_as', this.value)">
            </div>
            <div class="slider-group">
                <div class="slider-label"><span>ğŸ’¥ ì¹˜ëª…íƒ€ í™•ë¥ </span> <span id="val_crit">0</span></div>
                <input type="range" id="range_crit" min="0" max="10" value="0" oninput="updateRangeVal('val_crit', this.value)">
            </div>
            <div class="slider-group">
                <div class="slider-label"><span>â³ ìŠ¤í‚¬ ê°€ì†(ì¿¨ê°)</span> <span id="val_ah">0</span></div>
                <input type="range" id="range_ah" min="0" max="10" value="0" oninput="updateRangeVal('val_ah', this.value)">
            </div>
        </div>
        <button class="generate-btn" onclick="autoGenerateBuild()">ë‚´ ì…ë§›ëŒ€ë¡œ ì¡°í•© ìƒì„±í•˜ê¸°</button>
    </div>

    <div class="preset-bar">
        <div class="category-header" style="color:#00d2d3">ğŸŒ² ì •ê¸€ëŸ¬ (Jungle)</div>
        <button class="preset-btn jg-btn" onclick="applyPreset('jg_ad')">ğŸŒªï¸ AD ê°±í‚¹ (ë¦¬ì‹ /ì¹´ì§ìŠ¤)</button>
        <button class="preset-btn jg-btn" onclick="applyPreset('jg_ap')">ğŸ”¥ AP ëˆ„ì»¤ (ì—˜ë¦¬ìŠ¤/ì´ë¸”ë¦°)</button>
        <button class="preset-btn jg-btn" onclick="applyPreset('jg_tank')">ğŸ›¡ï¸ íƒ±ì»¤ (ì„¸ì£¼ì•„ë‹ˆ/ìí¬)</button>
        <button class="preset-btn jg-btn" onclick="applyPreset('jg_rpg')">âš”ï¸ ì„±ì¥í˜• (ë§ˆì´/ë¹„ì—ê³ )</button>

        <div class="category-header">ğŸ¹ ì›ê±°ë¦¬ ë”œëŸ¬ (ADC)</div>
        <button class="preset-btn adc-btn" onclick="applyPreset('adc_crit')">âš¡ ì¹˜ëª…íƒ€ (ì§•í¬ìŠ¤)</button>
        <button class="preset-btn adc-btn" onclick="applyPreset('adc_onhit')">ğŸŒªï¸ ê³µì†/ì ì¤‘ (ë² ì¸)</button>
        <button class="preset-btn adc-btn" onclick="applyPreset('adc_lethality')">ğŸ—¡ï¸ ë°©ê´€ í¬í‚¹ (ì§„)</button>
        <button class="preset-btn adc-btn" onclick="applyPreset('adc_caster')">ğŸ’§ ìŠ¤í‚¬í˜• (ì´ì¦ˆë¦¬ì–¼)</button>

        <div class="category-header">ğŸ”® ë¯¸ë“œ / íƒ‘</div>
        <button class="preset-btn" onclick="applyPreset('mage_burst')">ğŸ”¥ ëˆ„ì»¤ (í­ë”œ)</button>
        <button class="preset-btn" onclick="applyPreset('mage_poke')">â˜„ï¸ í¬í‚¹ (ì œë¼ìŠ¤)</button>
        <button class="preset-btn" onclick="applyPreset('assassin')">ğŸ—¡ï¸ ì•”ì‚´ì (íƒˆë¡ )</button>
        <button class="preset-btn" onclick="applyPreset('bruiser')">ğŸª“ ë¸Œë£¨ì € (ë‹¤ë¦¬ìš°ìŠ¤)</button>

        <div class="category-header">ğŸ›¡ï¸ ì„œí¬í„°</div>
        <button class="preset-btn" onclick="applyPreset('tank_hard')">ğŸ—¿ í“¨ì–´ íƒ±ì»¤</button>
        <button class="preset-btn" onclick="applyPreset('sup_util')">ğŸ§š ìœ í‹¸ ì„œí¿</button>
        <button class="preset-btn" onclick="applyPreset('sup_tank')">ğŸ›¡ï¸ íƒ± ì„œí¿</button>
    </div>

    <div class="inventory-box">
        <div class="slot" onclick="removeItem(0)"><span class="slot-hint">1</span></div>
        <div class="slot" onclick="removeItem(1)"><span class="slot-hint">2</span></div>
        <div class="slot" onclick="removeItem(2)"><span class="slot-hint">3</span></div>
        <div class="slot" onclick="removeItem(3)"><span class="slot-hint">4</span></div>
        <div class="slot" onclick="removeItem(4)"><span class="slot-hint">5</span></div>
        <div class="slot" onclick="removeItem(5)"><span class="slot-hint">6</span></div>
    </div>

    <div class="analysis-box">
        <div class="table-container">
            <span class="total-gold" id="totalPrice">0 G</span>
            <table class="stat-table">
                <tbody id="statBody">
                    <tr><td colspan="2" style="text-align:center">ì•„ì´í…œì„ ì¶”ê°€í•˜ì„¸ìš”</td></tr>
                </tbody>
            </table>
        </div>
        <div style="width:300px; height:300px; background:#111; padding:10px; border-radius:10px;">
            <canvas id="statChart"></canvas>
        </div>
    </div>

    <div class="search-box">
        <input type="text" id="search" placeholder="ì•„ì´í…œ ì´ë¦„ ê²€ìƒ‰..." onkeyup="filterItems()">
    </div>
    <div class="item-list" id="itemList"></div>

    <script>
        const VERSION = "14.3.1";
        const DATA_URL = `https://ddragon.leagueoflegends.com/cdn/${VERSION}/data/ko_KR/item.json`;
        const IMG_URL = `https://ddragon.leagueoflegends.com/cdn/${VERSION}/img/item/`;

        let allItems = [];
        let displayItems = [];
        let myInventory = [null, null, null, null, null, null];
        let radarChart;

        // --- 1. í”„ë¦¬ì…‹ ë°ì´í„° (ì •ê¸€ ì¶”ê°€ë¨) ---
        const PRESETS = {
            // [ğŸŒ² ì •ê¸€ëŸ¬]
            'jg_ad': ["ìš”ìš°ë¬´ì˜ ìœ ë ¹ê²€", "ì˜¤ë§Œ", "ì›ì¹™ì˜ ì›í˜•ë‚«", "ë°¤ì˜ ëìë½", "ì„¸ë¦´ë‹¤ì˜ ì›í•œ", "ê¸°ë™ë ¥ì˜ ì¥í™”"], // ìœ¡ì‹ (ì•”ì‚´)
            'jg_ap': ["ë¦¬ì¹˜ë² ì¸", "ê·¸ë¦¼ìë¶ˆê½ƒ", "ë¼ë°”ëˆì˜ ì£½ìŒëª¨ì", "ì¡´ì•¼ì˜ ëª¨ë˜ì‹œê³„", "ê³µí—ˆì˜ ì§€íŒ¡ì´", "ë§ˆë²•ì‚¬ì˜ ì‹ ë°œ"], // ì—˜ë¦¬ìŠ¤/ì´ë¸Œ
            'jg_tank': ["íƒœì–‘ë¶ˆê½ƒ ë°©íŒ¨", "ê°€ì‹œ ê°‘ì˜·", "í•´ì‹  ì‘ì‡¼", "ì¼€ì´ë‹‰ ë£¨ì»¨", "ì›Œëª¨ê·¸ì˜ ê°‘ì˜·", "íŒê¸ˆ ì¥í™”"], // ì´ˆì‹
            'jg_rpg': ["í¬ë¼ì¼„ í•™ì‚´ì", "ëª°ë½í•œ ì™•ì˜ ê²€", "êµ¬ì¸ìˆ˜ì˜ ê²©ë…¸ê²€", "ë§ˆë²•ì‚¬ì˜ ìµœí›„", "ì£½ìŒì˜ ë¬´ë„", "ê´‘ì „ì‚¬ì˜ êµ°í™”"], // ë§ˆì´/ë¹„ì—ê³ 

            // [ğŸ¹ ì›ë”œ]
            'adc_crit': ["ë¬´í•œì˜ ëŒ€ê²€", "í¬ë¼ì¼„ í•™ì‚´ì", "ë„ë¯¸ë‹‰ ê²½ì˜ ì¸ì‚¬", "ìœ ë ¹ ë¬´í¬", "í”¼ë°”ë¼ê¸°", "ê´‘ì „ì‚¬ì˜ êµ°í™”"],
            'adc_onhit': ["êµ¬ì¸ìˆ˜ì˜ ê²©ë…¸ê²€", "ëª°ë½í•œ ì™•ì˜ ê²€", "ë§ˆë²•ì‚¬ì˜ ìµœí›„", "ë£¨ë‚œì˜ í—ˆë¦¬ì¼€ì¸", "ê²½ê³„", "ê´‘ì „ì‚¬ì˜ êµ°í™”"],
            'adc_lethality': ["ìš”ìš°ë¬´ì˜ ìœ ë ¹ê²€", "ì§•ìˆ˜ì˜ ì´", "ë°¤ì˜ ëìë½", "ì„¸ë¦´ë‹¤ì˜ ì›í•œ", "ì›ì¹™ì˜ ì›í˜•ë‚«", "ì•„ì´ì˜¤ë‹ˆì•„ ì¥í™”"],
            'adc_caster': ["ì‚¼ìœ„ì¼ì²´", "ë§ˆë‚˜ë¬´ë„¤", "ì‡¼ì§„ì˜ ì°½", "ì„¸ë¦´ë‹¤ì˜ ì›í•œ", "êµ¶ì£¼ë¦° íˆë“œë¼", "ì•„ì´ì˜¤ë‹ˆì•„ ì¥í™”"],

            // [ğŸ”® ë¯¸ë“œ/íƒ‘]
            'mage_burst': ["ë¼ë°”ëˆì˜ ì£½ìŒëª¨ì", "ë£¨ë´ì˜ ë™ë°˜ì", "ê·¸ë¦¼ìë¶ˆê½ƒ", "ê³µí—ˆì˜ ì§€íŒ¡ì´", "ì¡´ì•¼ì˜ ëª¨ë˜ì‹œê³„", "ë§ˆë²•ì‚¬ì˜ ì‹ ë°œ"],
            'mage_poke': ["ë¦¬ì•ˆë“œë¦¬ì˜ ê³ í†µ", "ì§€í‰ì„ ì˜ ì´ˆì ", "ë¼ì¼ë¼ì´ì˜ ìˆ˜ì •í™€", "ìš°ì£¼ì˜ ì¶”ì§„ë ¥", "ëª¨ë ë¡œë…¸ë¯¸ì½˜", "ëª…ì„í•¨ì˜ ì•„ì´ì˜¤ë‹ˆì•„ ì¥í™”"],
            'assassin': ["ìš”ìš°ë¬´ì˜ ìœ ë ¹ê²€", "ë“œë½ì‚¬ë¥´ì˜ í™©í˜¼ê²€", "ë°¤ì˜ ëìë½", "ì„¸ë¦´ë‹¤ì˜ ì›í•œ", "ì£½ìŒì˜ ë¬´ë„", "ê¸°ë™ë ¥ì˜ ì¥í™”"],
            'bruiser': ["ì‚¼ìœ„ì¼ì²´", "ì£½ìŒì˜ ë¬´ë„", "ìŠ¤í…Œë½ì˜ ë„ì „", "ì¹ í‘ì˜ ì–‘ë‚  ë„ë¼", "ê±°ëŒ€í•œ íˆë“œë¼", "íŒê¸ˆ ì¥í™”"],

            // [ğŸ›¡ï¸ ì„œí¿]
            'tank_hard': ["ê°•ì² ì‹¬ì¥", "íƒœì–‘ë¶ˆê½ƒ ë°©íŒ¨", "ê°€ì‹œ ê°‘ì˜·", "ì •ë ¹ì˜ í˜•ìƒ", "ì›Œëª¨ê·¸ì˜ ê°‘ì˜·", "íŒê¸ˆ ì¥í™”"],
            'sup_util': ["ìŠˆë ë¦¬ì•„ì˜ êµ°ê°€", "ë¶ˆíƒ€ëŠ” í–¥ë¡œ", "íë¥´ëŠ” ë¬¼ì˜ ì§€íŒ¡ì´", "êµ¬ì›", "ë¯¸ì¹´ì—˜ì˜ ì¶•ë³µ", "ê¸°ë™ë ¥ì˜ ì¥í™”"],
            'sup_tank': ["ê°•ì² ì˜ ì†”ë¼ë¦¬ íœë˜íŠ¸", "ê¸°ì‚¬ì˜ ë§¹ì„¸", "ì§€í¬ì˜ ìœµí•©", "ê°€ì‹œ ê°‘ì˜·", "ì–¼ì–´ë¶™ì€ ì‹¬ì¥", "íŒê¸ˆ ì¥í™”"]
        };

        async function init() {
            const res = await fetch(DATA_URL);
            const json = await res.json();
            
            allItems = Object.values(json.data).filter(item => {
                const isConsumable = item.tags && item.tags.includes("Consumable");
                // ì˜¤ë¥¸í…œ ë“± í•„í„°ë§
                const isSpecial = item.requiredAlly || (item.description && item.description.includes("ê±¸ì‘"));
                return !isConsumable && !isSpecial && item.gold.total > 800;
            });

            displayItems = allItems;
            renderList();
        }

        // --- 2. ìŠ¤ë§ˆíŠ¸ ë¹Œë” ---
        function autoGenerateBuild() {
            const weights = {
                ad: parseInt(document.getElementById('range_ad').value),
                ap: parseInt(document.getElementById('range_ap').value),
                tank: parseInt(document.getElementById('range_tank').value),
                as: parseInt(document.getElementById('range_as').value),
                crit: parseInt(document.getElementById('range_crit').value),
                ah: parseInt(document.getElementById('range_ah').value)
            };

            const calculateScore = (item) => {
                let score = 0;
                if(item.stats.FlatPhysicalDamageMod) score += item.stats.FlatPhysicalDamageMod * weights.ad * 2;
                if(item.stats.FlatMagicDamageMod) score += item.stats.FlatMagicDamageMod * weights.ap * 2;
                if(item.stats.FlatHPPoolMod) score += (item.stats.FlatHPPoolMod / 10) * weights.tank;
                if(item.stats.FlatArmorMod) score += item.stats.FlatArmorMod * weights.tank * 2;
                if(item.stats.FlatSpellBlockMod) score += item.stats.FlatSpellBlockMod * weights.tank * 2;
                if(item.stats.PercentAttackSpeedMod) score += (item.stats.PercentAttackSpeedMod * 100) * weights.as;
                if(item.stats.FlatCritChanceMod) score += (item.stats.FlatCritChanceMod * 100) * weights.crit;
                if(item.tags && item.tags.includes("CooldownReduction")) score += 20 * weights.ah;
                return score;
            };

            const legendaries = allItems
                .filter(i => !i.tags.includes("Boots") && i.gold.total > 2000)
                .map(item => ({ item, score: calculateScore(item) }))
                .sort((a, b) => b.score - a.score);

            let bestBoot = "íŒê¸ˆ ì¥í™”";
            if (weights.ap > weights.ad) bestBoot = "ë§ˆë²•ì‚¬ì˜ ì‹ ë°œ";
            if (weights.as > 5 || weights.crit > 5) bestBoot = "ê´‘ì „ì‚¬ì˜ êµ°í™”";
            if (weights.ah > 6) bestBoot = "ëª…ì„í•¨ì˜ ì•„ì´ì˜¤ë‹ˆì•„ ì¥í™”";
            if (weights.ad > 6 && weights.tank < 3) bestBoot = "ê¸°ë™ë ¥ì˜ ì¥í™”"; // ì•”ì‚´ì/ì •ê¸€ì€ ê¸°ë™ë ¥

            myInventory = [null, null, null, null, null, null];
            
            const bootItem = allItems.find(i => i.name === bestBoot);
            if(bootItem) myInventory[5] = bootItem;

            let slot = 0;
            let addedNames = new Set();
            for(let i=0; i < legendaries.length; i++) {
                if(slot >= 5) break;
                const cand = legendaries[i].item;
                if(!addedNames.has(cand.name)) {
                    myInventory[slot] = cand;
                    addedNames.add(cand.name);
                    slot++;
                }
            }
            updateUI();
        }

        function updateRangeVal(id, val) { document.getElementById(id).innerText = val; }

        function renderList() {
            const div = document.getElementById("itemList");
            div.innerHTML = "";
            displayItems.slice(0, 100).forEach(i => {
                const img = document.createElement("img");
                img.src = IMG_URL + i.image.full;
                img.className = "item-card";
                img.onclick = () => addItem(i);
                img.title = i.name;
                div.appendChild(img);
            });
        }

        function addItem(item) {
            const idx = myInventory.indexOf(null);
            if(idx > -1) { myInventory[idx] = item; updateUI(); }
        }
        function removeItem(idx) { myInventory[idx] = null; updateUI(); }

        function applyPreset(type) {
            myInventory = [null, null, null, null, null, null];
            const names = PRESETS[type];
            let slot = 0;
            if(names) {
                names.forEach(name => {
                    const item = allItems.find(i => i.name === name);
                    if(item && slot < 6) { myInventory[slot] = item; slot++; }
                });
            }
            updateUI();
        }

        function updateUI() {
            const slots = document.querySelectorAll(".slot");
            let totalGold = 0;
            let stats = { "ê³µê²©ë ¥":0, "ì£¼ë¬¸ë ¥":0, "ì²´ë ¥":0, "ë°©ì–´ë ¥":0, "ë§ˆë²•ì €í•­":0, "ê³µì†":0, "ì¹˜ëª…íƒ€":0, "ì´ë™ì†ë„":0 };

            myInventory.forEach((item, i) => {
                slots[i].innerHTML = item ? `<img src="${IMG_URL + item.image.full}">` : "";
                if(item) {
                    totalGold += item.gold.total;
                    stats["ê³µê²©ë ¥"] += item.stats.FlatPhysicalDamageMod || 0;
                    stats["ì£¼ë¬¸ë ¥"] += item.stats.FlatMagicDamageMod || 0;
                    stats["ì²´ë ¥"] += item.stats.FlatHPPoolMod || 0;
                    stats["ë°©ì–´ë ¥"] += item.stats.FlatArmorMod || 0;
                    stats["ë§ˆë²•ì €í•­"] += item.stats.FlatSpellBlockMod || 0;
                    stats["ê³µì†"] += item.stats.PercentAttackSpeedMod || 0;
                    stats["ì¹˜ëª…íƒ€"] += item.stats.FlatCritChanceMod || 0;
                    stats["ì´ë™ì†ë„"] += item.stats.FlatMovementSpeedMod || 0;
                }
            });

            document.getElementById("totalPrice").innerText = totalGold.toLocaleString() + " G";
            const tbody = document.getElementById("statBody");
            tbody.innerHTML = "";
            for(let [k, v] of Object.entries(stats)) {
                if(v > 0) {
                    let displayV = v;
                    if(k === "ê³µì†" || k === "ì¹˜ëª…íƒ€") displayV = (v * 100).toFixed(0) + "%";
                    tbody.innerHTML += `<tr><td class="label">${k}</td><td>+${displayV}</td></tr>`;
                }
            }
            updateChart(stats);
        }

        function updateChart(s) {
            const ctx = document.getElementById('statChart').getContext('2d');
            const data = [s["ê³µê²©ë ¥"], s["ì£¼ë¬¸ë ¥"], s["ì²´ë ¥"]/10, s["ë°©ì–´ë ¥"], s["ë§ˆë²•ì €í•­"], s["ê³µì†"]*100];
            
            if(radarChart) {
                radarChart.data.datasets[0].data = data;
                radarChart.update();
            } else {
                radarChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['ê³µê²©', 'ì£¼ë¬¸', 'ì²´ë ¥/10', 'ë°©ì–´', 'ë§ˆë°©', 'ê³µì†'],
                        datasets: [{
                            label: 'ìŠ¤íƒ¯',
                            data: data,
                            backgroundColor: 'rgba(200, 170, 110, 0.2)',
                            borderColor: '#c8aa6e',
                            pointBackgroundColor: '#fff'
                        }]
                    },
                    options: {
                        scales: { r: { grid: { color: '#333' }, ticks: { display: false } } },
                        plugins: { legend: { display: false } }
                    }
                });
            }
        }

        function filterItems() {
            const key = document.getElementById("search").value;
            const filtered = allItems.filter(i => i.name.includes(key));
            const div = document.getElementById("itemList");
            div.innerHTML = "";
            filtered.slice(0, 100).forEach(i => {
                const img = document.createElement("img");
                img.src = IMG_URL + i.image.full;
                img.className = "item-card";
                img.onclick = () => addItem(i);
                div.appendChild(img);
            });
        }

        init();
    </script>
</body>
</html>
