<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PC LoL ì•„ì´í…œ ì—°êµ¬ì†Œ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* [í…Œë§ˆ: í—¥ìŠ¤í…Œí¬ ê³¨ë“œ & ë‹¤í¬ ë„¤ì´ë¹„] */
        body { 
            background-color: #091428; 
            color: #c8aa6e; 
            font-family: 'Pretendard', 'Noto Sans KR', sans-serif; 
            text-align: center; 
            padding: 20px; 
            margin: 0;
        }

        h1 { margin-bottom: 5px; text-shadow: 0 0 10px #c8aa6e; }
        p { color: #888; font-size: 14px; margin-bottom: 30px; }

        /* --- 1. ìë™ ì¡°í•© ë²„íŠ¼ ì˜ì—­ --- */
        .preset-container { margin-bottom: 30px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; border: 1px solid #444; display: inline-block; }
        .preset-title { font-size: 14px; color: #fff; margin-bottom: 10px; display: block; font-weight: bold; }
        .preset-btn {
            background: #1e2328; color: #cdbe91; border: 1px solid #c8aa6e;
            padding: 8px 16px; margin: 4px; cursor: pointer; border-radius: 4px; font-weight: bold; transition: 0.2s;
        }
        .preset-btn:hover { background: #c8aa6e; color: #000; box-shadow: 0 0 10px #c8aa6e; }

        /* --- 2. ì¸ë²¤í† ë¦¬ (6ì¹¸) --- */
        .inventory-box { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .slot { 
            width: 64px; height: 64px; 
            background: #010a13; border: 2px solid #5c5b57; 
            border-radius: 8px; cursor: pointer; position: relative;
            display: flex; align-items: center; justify-content: center;
        }
        .slot img { width: 100%; height: 100%; border-radius: 6px; }
        .slot:hover { border-color: #f0e6d2; box-shadow: 0 0 15px rgba(200, 170, 110, 0.5); }
        .slot::after { content: 'âŒ'; position: absolute; top: -5px; right: -5px; font-size: 12px; display: none; }
        .slot:hover::after { display: block; background: #000; border-radius: 50%; }

        /* --- 3. ë°ì´í„° ì‹œê°í™” (í‘œ + ì°¨íŠ¸) --- */
        .analysis-container { 
            display: flex; justify-content: center; flex-wrap: wrap; gap: 20px; 
            max-width: 900px; margin: 0 auto 40px auto; 
        }
        
        /* ìŠ¤íƒ¯ í‘œ (Table) ë””ìì¸ */
        .table-box { 
            flex: 1; min-width: 300px; 
            background: #1e2328; border: 2px solid #3c3c41; border-radius: 8px; padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .stat-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .stat-table th { border-bottom: 1px solid #555; padding: 8px; color: #fff; text-align: left; }
        .stat-table td { padding: 8px; border-bottom: 1px solid #333; color: #c8aa6e; font-weight: bold; text-align: right; }
        .stat-table .label-col { text-align: left; color: #a09b8c; font-weight: normal; }
        .total-price { font-size: 18px; color: #ffd700; text-align: right; margin-bottom: 10px; display: block; }

        /* ì°¨íŠ¸ ë°•ìŠ¤ */
        .chart-box { 
            width: 300px; height: 300px; 
            background: #1e2328; border: 2px solid #3c3c41; border-radius: 8px; padding: 10px;
        }

        /* --- 4. ì•„ì´í…œ í•„í„° ë° ë¦¬ìŠ¤íŠ¸ --- */
        .filter-bar { margin-bottom: 15px; }
        .filter-btn {
            background: transparent; color: #888; border: 1px solid #444;
            padding: 6px 12px; margin: 2px; cursor: pointer; border-radius: 20px;
        }
        .filter-btn.active { background: #c8aa6e; color: #091428; font-weight: bold; border-color: #c8aa6e; }

        .search-box input { 
            padding: 10px; width: 60%; max-width: 400px; 
            background: #1e2328; border: 1px solid #555; color: #fff; 
            border-radius: 5px; outline: none; text-align: center;
        }

        .item-list { 
            display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; 
            max-width: 1000px; margin: 20px auto; padding-bottom: 50px;
        }
        .item-card { 
            width: 50px; height: 50px; cursor: pointer; 
            border: 1px solid #333; overflow: hidden; transition: 0.2s;
        }
        .item-card img { width: 100%; height: 100%; }
        .item-card:hover { transform: scale(1.15); border: 2px solid #c8aa6e; z-index: 10; }

    </style>
</head>
<body>

    <h1>ğŸ—¡ï¸ PC LoL ì•„ì´í…œ ì¡°í•© ì—°êµ¬ì†Œ</h1>
    <p>ì›í•˜ëŠ” ì¡°í•©ì„ í´ë¦­í•˜ê±°ë‚˜ ì§ì ‘ ì•„ì´í…œì„ ê³¨ë¼ë³´ì„¸ìš”.</p>

    <div class="preset-container">
        <span class="preset-title">ğŸ¤– AI ìë™ ì¶”ì²œ ì¡°í•© (Click!)</span>
        <button class="preset-btn" onclick="applyPreset('ap_burst')">ğŸ”¥ AP í­ë”œ (ìŠ¤í‚¬ì½¤ë³´)</button>
        <button class="preset-btn" onclick="applyPreset('ad_lethality')">ğŸ¹ ì›ë”œ (ë°©ê´€)</button>
        <button class="preset-btn" onclick="applyPreset('ad_crit')">âš¡ ì›ë”œ (ì¹˜ëª…íƒ€)</button>
        <button class="preset-btn" onclick="applyPreset('tank_hard')">ğŸ›¡ï¸ ê·¹íƒ±ì»¤ (ì¢€ë¹„)</button>
        <button class="preset-btn" onclick="applyPreset('sup_util')">ğŸ¥ ìœ í‹¸ ì„œí¿</button>
    </div>

    <div class="inventory-box">
        <div class="slot" onclick="removeItem(0)"></div>
        <div class="slot" onclick="removeItem(1)"></div>
        <div class="slot" onclick="removeItem(2)"></div>
        <div class="slot" onclick="removeItem(3)"></div>
        <div class="slot" onclick="removeItem(4)"></div>
        <div class="slot" onclick="removeItem(5)"></div>
    </div>

    <div class="analysis-container">
        <div class="table-box">
            <span class="total-price" id="totalPrice">0 Gold</span>
            <table class="stat-table">
                <thead>
                    <tr><th colspan="2">ğŸ“Š ì¢…í•© ëŠ¥ë ¥ì¹˜ í•©ê³„</th></tr>
                </thead>
                <tbody id="statTableBody">
                    <tr><td class="label-col" colspan="2" style="text-align:center; color:#555;">ì•„ì´í…œì„ ì¶”ê°€í•˜ì„¸ìš”</td></tr>
                </tbody>
            </table>
        </div>
        <div class="chart-box">
            <canvas id="statChart"></canvas>
        </div>
    </div>

    <div class="filter-bar">
        <button class="filter-btn active" onclick="setFilter('all')">ì „ì²´</button>
        <button class="filter-btn" onclick="setFilter('Damage')">âš”ï¸ ê³µê²©ë ¥</button>
        <button class="filter-btn" onclick="setFilter('SpellDamage')">ğŸ”® ì£¼ë¬¸ë ¥</button>
        <button class="filter-btn" onclick="setFilter('Defense')">ğŸ›¡ï¸ ë°©ì–´/íƒ±</button>
        <button class="filter-btn" onclick="setFilter('AttackSpeed')">âš¡ ê³µì†</button>
        <button class="filter-btn" onclick="setFilter('Boots')">ğŸ‘Ÿ ì‹ ë°œ</button>
    </div>

    <div class="search-box">
        <input type="text" id="search" placeholder="ì•„ì´í…œ ì´ë¦„ ê²€ìƒ‰..." onkeyup="filterItems()">
    </div>

    <div class="item-list" id="itemList"></div>

    <script>
        // --- ì„¤ì • ---
        const VERSION = "14.3.1"; // íŒ¨ì¹˜ ë²„ì „
        const DATA_URL = `https://ddragon.leagueoflegends.com/cdn/${VERSION}/data/ko_KR/item.json`;
        const IMG_URL = `https://ddragon.leagueoflegends.com/cdn/${VERSION}/img/item/`;

        let allItems = [];      // ì „ì²´ ì•„ì´í…œ
        let displayItems = [];  // í™”ë©´ì— ë³´ì—¬ì¤„ ì•„ì´í…œ (í•„í„°ë§ë¨)
        let myInventory = [null, null, null, null, null, null];
        let radarChart;
        let currentFilter = 'all';

        // --- ìë™ ì¡°í•© ë°ì´í„° (í”„ë¦¬ì…‹) ---
        // ê°œë°œì ë…¸íŠ¸: ì—¬ê¸°ì— ì›í•˜ëŠ” ì¡°í•©ì„ ì•„ì´í…œ 'ì´ë¦„'ìœ¼ë¡œ ì ì–´ë‘ë©´ ë©ë‹ˆë‹¤.
        const PRESETS = {
            'ap_burst': ["ë¼ë°”ëˆì˜ ì£½ìŒëª¨ì", "ë£¨ë´ì˜ ë™ë°˜ì", "ê·¸ë¦¼ìë¶ˆê½ƒ", "ê³µí—ˆì˜ ì§€íŒ¡ì´", "ì¡´ì•¼ì˜ ëª¨ë˜ì‹œê³„", "ë§ˆë²•ì‚¬ì˜ ì‹ ë°œ"],
            'ad_lethality': ["ìš”ìš°ë¬´ì˜ ìœ ë ¹ê²€", "ì§•ìˆ˜ì˜ ì´", "ë°¤ì˜ ëìë½", "ì„¸ë¦´ë‹¤ì˜ ì›í•œ", "ì›ì¹™ì˜ ì›í˜•ë‚«", "ì•„ì´ì˜¤ë‹ˆì•„ ì¥í™”"],
            'ad_crit': ["ë¬´í•œì˜ ëŒ€ê²€", "í¬ë¼ì¼„ í•™ì‚´ì", "ë„ë¯¸ë‹‰ ê²½ì˜ ì¸ì‚¬", "ìœ ë ¹ ë¬´í¬", "í”¼ë°”ë¼ê¸°", "ê´‘ì „ì‚¬ì˜ êµ°í™”"],
            'tank_hard': ["ê°•ì² ì‹¬ì¥", "íƒœì–‘ë¶ˆê½ƒ ë°©íŒ¨", "ê°€ì‹œ ê°‘ì˜·", "ì •ë ¹ì˜ í˜•ìƒ", "ì›Œëª¨ê·¸ì˜ ê°‘ì˜·", "íŒê¸ˆ ì¥í™”"],
            'sup_util': ["ìŠˆë ë¦¬ì•„ì˜ êµ°ê°€", "ë¶ˆíƒ€ëŠ” í–¥ë¡œ", "íë¥´ëŠ” ë¬¼ì˜ ì§€íŒ¡ì´", "êµ¬ì›", "ë¯¸ì¹´ì—˜ì˜ ì¶•ë³µ", "ê¸°ë™ë ¥ì˜ ì¥í™”"]
        };

        // 1. ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function init() {
            try {
                const res = await fetch(DATA_URL);
                const json = await res.json();
                
                // ì „ì„¤í…œ(ìµœì¢…í…œ) ìœ„ì£¼ë¡œ í•„í„°ë§: ê°€ê²© 1500 ì´ìƒ & ì†Œëª¨í’ˆ ì•„ë‹˜
                // ë‹¨, ì‹ ë°œì€ ê°€ê²©ì´ ì‹¸ë„ í¬í•¨í•´ì•¼ í•¨
                allItems = Object.values(json.data).filter(item => {
                    const isBoot = item.tags && item.tags.includes("Boots");
                    const isCompleted = item.gold.total > 1500 && !item.tags.includes("Consumable");
                    return isCompleted || (isBoot && item.gold.total > 800); // ë˜¥ì‹ ë°œ ì œì™¸
                });

                displayItems = allItems;
                renderList();
            } catch (e) {
                alert("ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                console.error(e);
            }
        }

        // 2. í™”ë©´ì— ì•„ì´í…œ ë¿Œë¦¬ê¸°
        function renderList() {
            const listDiv = document.getElementById("itemList");
            listDiv.innerHTML = "";
            
            // ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ìµœëŒ€ 100ê°œê¹Œì§€ë§Œ ë Œë”ë§ (ê²€ìƒ‰í•˜ë©´ ë‹¤ ë‚˜ì˜´)
            const limit = displayItems.length > 100 ? 100 : displayItems.length;

            for(let i=0; i<limit; i++) {
                const item = displayItems[i];
                const div = document.createElement("div");
                div.className = "item-card";
                div.innerHTML = `<img src="${IMG_URL + item.image.full}" title="${item.name}\nê°€ê²©: ${item.gold.total}">`;
                div.onclick = () => addItem(item);
                listDiv.appendChild(div);
            }
        }

        // 3. í•„í„°ë§ ë¡œì§ (ì¹´í…Œê³ ë¦¬)
        function setFilter(tag) {
            currentFilter = tag;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ í™œì„±í™”
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (tag === 'all') {
                displayItems = allItems;
            } else {
                // Riot ë°ì´í„°ì˜ 'tags' ë°°ì—´ í™œìš©
                displayItems = allItems.filter(item => item.tags && item.tags.includes(tag));
            }
            renderList();
        }

        function filterItems() {
            const keyword = document.getElementById("search").value;
            displayItems = allItems.filter(item => item.name.includes(keyword));
            renderList();
        }

        // 4. ì¸ë²¤í† ë¦¬ ì¡°ì‘ & ìë™ ì¡°í•©
        function addItem(item) {
            const idx = myInventory.indexOf(null);
            if(idx > -1) { myInventory[idx] = item; updateUI(); }
            else { alert("ì¸ë²¤í† ë¦¬ê°€ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤! ì•„ì´í…œì„ í´ë¦­í•´ì„œ ë¹„ìš°ì„¸ìš”."); }
        }

        function removeItem(idx) { myInventory[idx] = null; updateUI(); }

        function applyPreset(type) {
            const targetNames = PRESETS[type];
            if(!targetNames) return;

            // ì¸ë²¤í† ë¦¬ ë¹„ìš°ê¸°
            myInventory = [null, null, null, null, null, null];

            // ì´ë¦„ìœ¼ë¡œ ì•„ì´í…œ ì°¾ì•„ì„œ ë„£ê¸°
            let slotIdx = 0;
            targetNames.forEach(name => {
                const foundItem = allItems.find(item => item.name === name);
                if(foundItem && slotIdx < 6) {
                    myInventory[slotIdx] = foundItem;
                    slotIdx++;
                }
            });
            updateUI();
        }

        // 5. í•µì‹¬: UI ì—…ë°ì´íŠ¸ (í‘œ + ì°¨íŠ¸)
        function updateUI() {
            const slots = document.querySelectorAll(".slot");
            let totalPrice = 0;
            
            // í•©ì‚°í•  ìŠ¤íƒ¯ ì •ì˜ (Riot API Key -> í•œê¸€ ëª…ì¹­)
            let stats = {
                "FlatPhysicalDamageMod": { val: 0, name: "ê³µê²©ë ¥" },
                "FlatMagicDamageMod": { val: 0, name: "ì£¼ë¬¸ë ¥" },
                "FlatHPPoolMod": { val: 0, name: "ì²´ë ¥" },
                "FlatArmorMod": { val: 0, name: "ë°©ì–´ë ¥" },
                "FlatSpellBlockMod": { val: 0, name: "ë§ˆë²•ì €í•­" },
                "PercentAttackSpeedMod": { val: 0, name: "ê³µê²© ì†ë„" },
                "FlatCritChanceMod": { val: 0, name: "ì¹˜ëª…íƒ€" },
                "FlatMovementSpeedMod": { val: 0, name: "ì´ë™ ì†ë„" }
            };

            // ì¸ë²¤í† ë¦¬ ìˆœíšŒí•˜ë©° í•©ì‚°
            myInventory.forEach((item, i) => {
                slots[i].innerHTML = item ? `<img src="${IMG_URL + item.image.full}">` : "";
                
                if(item) {
                    totalPrice += item.gold.total;
                    for (const [key, obj] of Object.entries(stats)) {
                        if (item.stats[key]) {
                            stats[key].val += item.stats[key];
                        }
                    }
                }
            });

            // A. í‘œ(Table) ì—…ë°ì´íŠ¸
            document.getElementById("totalPrice").innerText = totalPrice.toLocaleString() + " Gold";
            const tbody = document.getElementById("statTableBody");
            tbody.innerHTML = "";

            let hasStat = false;
            for (const [key, obj] of Object.entries(stats)) {
                if (obj.val > 0) {
                    hasStat = true;
                    let displayVal = obj.val;
                    if(key === 'PercentAttackSpeedMod' || key === 'FlatCritChanceMod') {
                        displayVal = (obj.val * 100).toFixed(0) + "%"; // í¼ì„¼íŠ¸ ë³€í™˜
                    }
                    
                    const tr = document.createElement("tr");
                    tr.innerHTML = `<td class="label-col">${obj.name}</td><td>+${displayVal}</td>`;
                    tbody.appendChild(tr);
                }
            }
            if(!hasStat) {
                tbody.innerHTML = `<tr><td colspan="2" style="text-align:center; padding:20px; color:#555;">ì¡°í•©ëœ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤</td></tr>`;
            }

            // B. ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateChart(stats);
        }

        // 6. ì°¨íŠ¸ ê·¸ë¦¬ê¸°
        function updateChart(s) {
            const ctx = document.getElementById('statChart').getContext('2d');
            // ì°¨íŠ¸ìš© ë°ì´í„° ì •ê·œí™” (ì²´ë ¥ì€ ë„ˆë¬´ ì»¤ì„œ ë‚˜ëˆ„ê¸°)
            const dataValues = [
                s.FlatPhysicalDamageMod.val, 
                s.FlatMagicDamageMod.val, 
                s.FlatHPPoolMod.val / 10, 
                s.FlatArmorMod.val, 
                s.FlatSpellBlockMod.val,
                s.PercentAttackSpeedMod.val * 100 
            ];

            if(radarChart) {
                radarChart.data.datasets[0].data = dataValues;
                radarChart.update();
            } else {
                radarChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['ê³µê²©ë ¥', 'ì£¼ë¬¸ë ¥', 'ì²´ë ¥/10', 'ë°©ì–´', 'ë§ˆë°©', 'ê³µì†'],
                        datasets: [{
                            label: 'ìŠ¤íƒ¯ ë°¸ëŸ°ìŠ¤',
                            data: dataValues,
                            backgroundColor: 'rgba(200, 170, 110, 0.2)', // LoL ê³¨ë“œìƒ‰
                            borderColor: '#c8aa6e',
                            borderWidth: 2,
                            pointBackgroundColor: '#fff'
                        }]
                    },
                    options: {
                        scales: {
                            r: {
                                angleLines: { color: '#333' },
                                grid: { color: '#333' },
                                pointLabels: { color: '#aaa', font: {size: 11} },
                                ticks: { display: false, maxTicksLimit: 5 },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }
        }

        // ì‹œì‘
        init();
    </script>
</body>
</html>
